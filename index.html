<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Ambition Tracker</title>
  <style>
    body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
    h1 { text-align: center; }

    /* XP Bar */
    .xp-bar { margin: 20px 0; }
    .progress-bar { height: 25px; background: #eee; border-radius: 12px; overflow: hidden; }
    .progress-bar-inner { height: 100%; background: linear-gradient(90deg, #4caf50, #81c784); width: 0%; transition: width 0.5s; }

    /* Goals */
    .goal { margin-bottom: 20px; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }

    /* Rewards section */
    #rewards { margin-top: 10px; }
    .badge { display: inline-block; margin: 5px; padding: 8px 12px; background: gold; border-radius: 20px; font-weight: bold; }
    
    /* Popup animation */
    .reward-popup {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: #ffeb3b;
      padding: 15px 25px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      font-size: 1.2em;
      font-weight: bold;
      opacity: 0;
      pointer-events: none;
      animation: popupFade 3s forwards;
      z-index: 9999;
    }

    @keyframes popupFade {
      0% { opacity: 0; transform: translate(-50%, -30px); }
      20% { opacity: 1; transform: translate(-50%, 0); }
      80% { opacity: 1; }
      100% { opacity: 0; transform: translate(-50%, -30px); }
    }
  </style>
</head>
<body>
  <h1>üéØ My Ambition Tracker</h1>

  <!-- XP Bar -->
  <div class="xp-bar">
    <h2>XP Progress</h2>
    <div class="progress-bar">
      <div id="xp-bar-inner" class="progress-bar-inner"></div>
    </div>
    <p id="xp-info">XP: 0 / 10 (Level 1)</p>
    <div id="rewards"></div>
  </div>

  <div id="dashboard"></div>
  <button id="add-goal">Add Goal</button>

  <script>
    // --- SETTINGS ---
    const POINTS_PER_ACTION = 1;   // Punkte pro Klick
    const XP_PER_LEVEL = 10;       // Punkte f√ºr ein Level
    const STORAGE_KEY = "ambition-tracker-data";

    // --- STATE (wird ggf. aus localStorage geladen) ---
    let totalXP = 0;
    let currentLevel = 1;
    let rewards = [];
    let goals = [];

    // --- LOAD FROM STORAGE ---
    function loadState() {
      const saved = localStorage.getItem(STORAGE_KEY);
      if (saved) {
        try {
          const data = JSON.parse(saved);
          totalXP = data.totalXP || 0;
          currentLevel = data.currentLevel || 1;
          rewards = data.rewards || [];
          goals = data.goals || [];
        } catch (e) {
          console.error("Error loading state:", e);
        }
      } else {
        // Default goals, falls noch nichts gespeichert
        goals = [{ id: 1, name: "Read 20 pages", target: 20, progress: 0 }];
      }
    }

    // --- SAVE TO STORAGE ---
    function saveState() {
      const data = { totalXP, currentLevel, rewards, goals };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
    }

    // --- RENDERING ---
    function renderXP() {
      const xpInLevel = totalXP % XP_PER_LEVEL;
      const percent = (xpInLevel / XP_PER_LEVEL) * 100;

      document.getElementById("xp-bar-inner").style.width = percent + "%";
      document.getElementById("xp-info").innerText =
        `XP: ${xpInLevel} / ${XP_PER_LEVEL} (Level ${currentLevel})`;

      document.getElementById("rewards").innerHTML =
        rewards.map(r => `<span class="badge">üèÜ ${r}</span>`).join(" ");
    }

    function renderGoals() {
      const dash = document.getElementById("dashboard");
      dash.innerHTML = "";
      goals.forEach(goal => {
        const div = document.createElement("div");
        div.className = "goal";
        div.innerHTML = `
          <h3>${goal.name}</h3>
          <p>Progress: ${goal.progress} / ${goal.target}</p>
          <button onclick="incProgress(${goal.id})">+1</button>
        `;
        dash.appendChild(div);
      });
    }

    // --- LOGIC ---
    function incProgress(goalId) {
      const goal = goals.find(g => g.id === goalId);
      if (!goal) return;
      goal.progress += 1;

      // XP erh√∂hen
      totalXP += POINTS_PER_ACTION;
      checkLevelUp();

      renderGoals();
      renderXP();
      saveState();
    }

    function checkLevelUp() {
      const newLevel = Math.floor(totalXP / XP_PER_LEVEL) + 1;
      if (newLevel > currentLevel) {
        currentLevel = newLevel;
        const reward = `Level ${currentLevel} reached!`;
        rewards.push(reward);
        showRewardPopup(reward);
        saveState();
      }
    }

    function showRewardPopup(text) {
      const popup = document.createElement("div");
      popup.className = "reward-popup";
      popup.innerText = `üéâ ${text} üéâ`;
      document.body.appendChild(popup);
      setTimeout(() => popup.remove(), 3000);
    }

    // Goal hinzuf√ºgen
    document.getElementById("add-goal").addEventListener("click", () => {
      const name = prompt("Goal name:");
      const target = parseInt(prompt("Target (units):"), 10);
      if (name && target > 0) {
        const id = goals.length ? goals[goals.length - 1].id + 1 : 1;
        goals.push({ id, name, target, progress: 0 });
        renderGoals();
        saveState();
      }
    });

    // --- INIT ---
    loadState();
    renderGoals();
    renderXP();
  </script>
</body>
</html>
